{"version":3,"sources":["AppContext.js","components/Layout/Loader.js","App.js","index.js"],"names":["logoutTimer","AppContext","React","createContext","calculateRemainingTime","expirationTime","currentTime","Date","getTime","ContextProvider","props","initialToken","tokenData","storedToken","localStorage","getItem","storedExpirationDate","remainingTime","removeItem","token","duration","retrieveStoredToken","currentEmail","useState","isLogin","setIsLogin","email","setEmail","setToken","userIsLoggedIn","logoutHandler","useCallback","clearTimeout","useEffect","setTimeout","loading","setLoading","places","setPlaces","searchTerm","setSearchTerm","a","fetch","response","ok","Error","json","key","data","loadedPlaces","push","id","name","info","price","image","fetchPlaces","catch","error","console","log","Provider","value","isLoggedIn","switchAuthModeHandler","text","loginHandler","setItem","emailHandler","children","useAppContext","useContext","Loader","className","AuthPage","lazy","HomePage","ProfilePage","BookingsPage","Presence","App","fallback","path","exact","to","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.b0b6b3c4.chunk.js","sourcesContent":["import React, { useState, useContext, useEffect, useCallback } from 'react';\r\n\r\nconst AppContext = React.createContext();\r\n\r\nlet logoutTimer;\r\n\r\nconst calculateRemainingTime = (expirationTime) => {\r\n\tconst currentTime = new Date().getTime();\r\n\tconst adjExpirationTime = new Date(expirationTime).getTime();\r\n\r\n\tconst remainingTime = adjExpirationTime - currentTime;\r\n\treturn remainingTime;\r\n};\r\n\r\nconst retrieveStoredToken = () => {\r\n\tconst storedToken = localStorage.getItem('token');\r\n\tconst storedExpirationDate = localStorage.getItem('expirationTime');\r\n\r\n\tconst remainingTime = calculateRemainingTime(storedExpirationDate);\r\n\r\n\tif (remainingTime <= 60000) {\r\n\t\tlocalStorage.removeItem('token');\r\n\t\tlocalStorage.removeItem('email');\r\n\t\tlocalStorage.removeItem('expirationTime');\r\n\t\treturn null;\r\n\t}\r\n\r\n\treturn {\r\n\t\ttoken: storedToken,\r\n\t\tduration: remainingTime\r\n\t};\r\n};\r\n\r\nexport const ContextProvider = (props) => {\r\n\t// Authentication\r\n\tconst tokenData = retrieveStoredToken();\r\n\tlet initialToken;\r\n\tif (tokenData) {\r\n\t\tinitialToken = tokenData.token;\r\n\t}\r\n\t\r\n\tconst currentEmail = localStorage.getItem('email');\r\n\r\n\tconst [isLogin, setIsLogin] = useState(null);\r\n\tconst [email, setEmail] = useState(currentEmail);\r\n\tconst [token, setToken] = useState(initialToken);\r\n\tconst userIsLoggedIn = !!token;\r\n\r\n\r\n\tconst emailHandler = (email) => {\r\n\t\tsetEmail(email);\r\n\t\tlocalStorage.setItem('email', email);\r\n\t};\r\n\r\n\tconst logoutHandler = useCallback(() => {\r\n\t\tsetToken(null);\r\n\t\tsetEmail(null);\r\n\r\n\t\tlocalStorage.removeItem('token');\r\n\t\tlocalStorage.removeItem('email');\r\n\t\tlocalStorage.removeItem('expirationTime');\r\n\r\n\t\tif (logoutTimer) {\r\n\t\t\tclearTimeout(logoutTimer);\r\n\t\t}\r\n\t}, []);\r\n\r\n\tconst loginHandler = (token, expirationTime) => {\r\n\t\tsetToken(token);\r\n\r\n\t\tlocalStorage.setItem('token', token);\r\n\t\tlocalStorage.setItem('expirationTime', expirationTime);\r\n\r\n\t\tconst remainingTime = calculateRemainingTime(expirationTime);\r\n\r\n\t\tlogoutTimer = setTimeout(logoutHandler, remainingTime);\r\n\t};\r\n\r\n\r\n\tuseEffect(() => {\r\n\t\tif (tokenData) {\r\n\t\t\tlogoutTimer = setTimeout(logoutHandler, tokenData.duration);\r\n\t\t}\r\n\t}, [tokenData, logoutHandler]);\r\n\r\n\r\n\tconst switchAuthModeHandler = (text) => {\r\n\t\tif (text === 'Log in') {\r\n\t\t\tsetIsLogin(true);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tsetIsLogin(false);\r\n\t\t}\r\n\t};\r\n\r\n\t// Displaying places\r\n\tconst [loading, setLoading] = useState(true);\r\n\tconst [places, setPlaces] = useState([]);\r\n\tconst [searchTerm, setSearchTerm] = useState('');\r\n\r\n\tuseEffect(() => {\r\n\t\tconst fetchPlaces = async () => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tconst response = await fetch(`https://parklane-24dk-default-rtdb.firebaseio.com/places.json?auth=${token}`);\r\n\t\t\tif (!response.ok) {\r\n\t\t\t\tthrow new Error('Something went wrong!');\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconst data = await response.json();\r\n\t\t\tconst loadedPlaces = [];\r\n\r\n\t\t\tfor (const key in data) {\r\n\t\t\t\tloadedPlaces.push({\r\n\t\t\t\t\tid: key,\r\n\t\t\t\t\tname: data[key].name,\r\n\t\t\t\t\tinfo: data[key].info,\r\n\t\t\t\t\tprice: data[key].price,\r\n\t\t\t\t\timage: data[key].image\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tsetPlaces(loadedPlaces);\r\n\t\t\tsetLoading(false);\r\n\t\t};\r\n\r\n\t\tfetchPlaces().catch(error => {\r\n\t\t\tconsole.log(error);\r\n\t\t\tsetLoading(false);\r\n\t\t});\r\n\t}, [token]);\r\n\r\n\treturn (\r\n\t\t<AppContext.Provider value = {{\r\n\t\t\tisLogin,\r\n\t\t\ttoken,\r\n\t\t\temail, \r\n\t\t\tloading, \r\n\t\t\tplaces,\r\n\t\t\tsearchTerm,\r\n\t\t\tsetSearchTerm,\r\n\t\t\tisLoggedIn: userIsLoggedIn,\r\n\t\t\tswitchAuthModeHandler,\r\n\t\t\tloginHandler,\r\n\t\t\tlogoutHandler,\r\n\t\t\temailHandler\r\n\t\t}}>\r\n\t\t\t{props.children}\r\n\t\t</AppContext.Provider>\r\n\t);\r\n};\r\n\r\nexport const useAppContext = () => {\r\n\treturn useContext(AppContext);\r\n};\r\n\r\n","import React from 'react';\r\n\r\nconst Loader = () => {\r\n  \r\n return (\r\n  <div className = \"centered\">\r\n    <div className=\"lds-grid\">\r\n      <div></div>\r\n      <div></div>\r\n      <div></div>\r\n      <div></div>\r\n      <div></div>\r\n      <div></div>\r\n      <div></div>\r\n      <div></div>\r\n      <div></div>\r\n    </div>\r\n  </div>\r\n );\r\n};\r\n\r\nexport default Loader;","import React, { Suspense } from 'react';\nimport { Switch, Route, Redirect } from 'react-router-dom';\nimport {useAppContext} from './AppContext';\nimport Loader from './components/Layout/Loader';\n\nconst AuthPage = React.lazy(() => import('./pages/AuthPage'));\nconst HomePage = React.lazy(() => import('./pages/HomePage'));\nconst ProfilePage = React.lazy(() => import('./pages/ProfilePage'));\nconst BookingsPage = React.lazy(() => import('./pages/BookingsPage'));\nconst Presence = React.lazy(() => import('./components/StartingPage/Presence'));\n\nfunction App() {\n  const {isLoggedIn} = useAppContext();\n\n  return (\n    <Suspense fallback = {<Loader />}>\n      <Switch>\n        <Route path='/' exact>\n          <HomePage />\n        </Route>\n\n        <Route path='/auth'>\n          {isLoggedIn && <HomePage />}\n          {!isLoggedIn && <AuthPage />}\n        </Route>\n\n        {isLoggedIn && (\n          <Route path='/profile' exact>\n            <Presence />\n          </Route>\n        )}\n\n        {isLoggedIn && (\n          <Route path='/bookings' exact>\n            <BookingsPage />\n          </Route>\n        )}\n\n        {isLoggedIn && (\n          <Route path = '/profile/:placeId'>\n            <ProfilePage />\n          </Route>\n        )}\n\n        <Route path = '*'>\n          <Redirect to = '/' />\n        </Route>\n      </Switch>\n    </Suspense>\n  );\n}\n\nexport default App;\n","import ReactDOM from 'react-dom';\nimport { BrowserRouter } from 'react-router-dom';\nimport './index.css';\nimport App from './App';\nimport {ContextProvider} from './AppContext';\n\n\nReactDOM.render(\n  <BrowserRouter>\n    <ContextProvider>\n      <App />\n    </ContextProvider>\n  </BrowserRouter>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}